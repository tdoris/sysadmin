<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sysadmin Dashboard - {{ hostname }}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="container">
        <header>
            <h1>ü§ñ Claude Code Sysadmin Dashboard</h1>
            <div class="hostname">{{ hostname }}</div>
        </header>

        <!-- Quick Launch Section -->
        <section class="launch-section">
            <h2>üöÄ Launch Interactive Session</h2>
            <div class="command-box">
                <code id="claude-command">{{ claude_command }}</code>
                <button onclick="copyCommand()" class="btn-copy">Copy</button>
            </div>
            <p class="help-text">Run this command in your terminal to start an interactive Claude Code sysadmin session</p>
        </section>

        <!-- System Status Cards -->
        <section class="status-cards">
            <div class="card" id="disk-card">
                <h3>Disk Usage</h3>
                <div class="metric">
                    <span class="value" id="disk-usage">--</span>
                    <span class="unit">%</span>
                </div>
                <div class="card-details">
                    <div class="detail-row">
                        <span class="detail-label">Used:</span>
                        <span class="detail-value" id="disk-used">--</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Available:</span>
                        <span class="detail-value" id="disk-available">--</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Total:</span>
                        <span class="detail-value" id="disk-total">--</span>
                    </div>
                </div>
            </div>
            <div class="card" id="memory-card">
                <h3>Memory Usage</h3>
                <div class="metric">
                    <span class="value" id="memory-usage">--</span>
                    <span class="unit">%</span>
                </div>
                <div class="card-details">
                    <div class="detail-row">
                        <span class="detail-label">Used:</span>
                        <span class="detail-value" id="memory-used">--</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Available:</span>
                        <span class="detail-value" id="memory-available">--</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Total:</span>
                        <span class="detail-value" id="memory-total">--</span>
                    </div>
                </div>
            </div>
            <div class="card" id="cpu-card">
                <h3>CPU</h3>
                <div class="card-info">
                    <div class="info-model" id="cpu-model">--</div>
                    <div class="card-details">
                        <div class="detail-row">
                            <span class="detail-label">Cores:</span>
                            <span class="detail-value" id="cpu-cores">--</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Threads:</span>
                            <span class="detail-value" id="cpu-threads">--</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Load:</span>
                            <span class="detail-value" id="cpu-load">--</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="card" id="network-card">
                <h3>Network</h3>
                <div class="card-info">
                    <div class="info-model" id="network-interface">--</div>
                    <div class="card-details">
                        <div class="detail-row">
                            <span class="detail-label">RX:</span>
                            <span class="detail-value" id="network-rx">--</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">TX:</span>
                            <span class="detail-value" id="network-tx">--</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Status:</span>
                            <span class="detail-value" id="network-status">--</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="card" id="uptime-card">
                <h3>Uptime</h3>
                <div class="metric">
                    <span class="value small" id="uptime">--</span>
                </div>
            </div>
            <div class="card gpu-card" id="gpu-card">
                <h3>GPU</h3>
                <div class="card-info">
                    <div class="info-model" id="gpu-model">--</div>
                    <div class="card-details">
                        <div class="detail-row">
                            <span class="detail-label">Temp:</span>
                            <span class="detail-value" id="gpu-temp">--</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Memory:</span>
                            <span class="detail-value" id="gpu-memory">--</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Util:</span>
                            <span class="detail-value" id="gpu-util">--</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Driver:</span>
                            <span class="detail-value" id="gpu-driver">--</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ML Framework Status Section -->
        <section class="ml-frameworks-section">
            <h2>Machine Learning Environment</h2>
            <p class="section-description">System-wide ML framework installations (check virtual environments for project-specific installations)</p>
            <div class="frameworks-list">
                <div class="framework-item" id="cuda-item">
                    <div class="framework-name">CUDA Toolkit</div>
                    <div class="framework-value" id="cuda-version">--</div>
                    <div class="framework-indicator" id="cuda-indicator"></div>
                </div>
                <div class="framework-item" id="pytorch-item">
                    <div class="framework-name">PyTorch</div>
                    <div class="framework-value" id="pytorch-version">--</div>
                    <div class="framework-indicator" id="pytorch-indicator"></div>
                </div>
                <div class="framework-item" id="tensorflow-item">
                    <div class="framework-name">TensorFlow</div>
                    <div class="framework-value" id="tensorflow-version">--</div>
                    <div class="framework-indicator" id="tensorflow-indicator"></div>
                </div>
            </div>
            <div class="venvs-link">
                <a href="/venvs" class="btn-secondary">üì¶ Browse Virtual Environments ‚Üí</a>
            </div>
        </section>

        <!-- Pending Approvals Section -->
        <section class="approvals-section" id="approvals-section" style="display: none;">
            <h2>‚úã Pending Approvals</h2>
            <p class="section-description">These actions require your approval before Claude Code can execute them.</p>
            <div id="approvals-container"></div>
        </section>

        <!-- Alerts Section -->
        <section class="alerts-section">
            <h2>‚ö†Ô∏è Active Alerts</h2>
            <div class="alerts-summary">
                <span class="alert-badge critical" id="critical-count">0</span>
                <span class="alert-badge high" id="high-count">0</span>
                <span class="alert-badge medium" id="medium-count">0</span>
            </div>
            <div id="alerts-container"></div>
        </section>

        <!-- Actions Section -->
        <section class="actions-section">
            <h2>‚ö° Quick Actions</h2>
            <div class="actions-grid">
                <button onclick="triggerJob('hourly')" class="btn-action">
                    <span class="icon">üîç</span>
                    <span>Run Hourly Check</span>
                </button>
                <button onclick="triggerJob('daily')" class="btn-action">
                    <span class="icon">üîß</span>
                    <span>Run Daily Maintenance</span>
                </button>
                <button onclick="refreshAll()" class="btn-action">
                    <span class="icon">üîÑ</span>
                    <span>Refresh Dashboard</span>
                </button>
            </div>
            <div id="action-status"></div>
        </section>

        <!-- Tabs for Details -->
        <section class="details-section">
            <div class="tabs">
                <button class="tab active" onclick="showTab('activity')">Recent Activity</button>
                <button class="tab" onclick="showTab('recommendations')">Recommendations</button>
                <button class="tab" onclick="showTab('report')">System Report</button>
                <button class="tab" onclick="showTab('apps')">Monitored Apps</button>
            </div>

            <div id="activity-tab" class="tab-content active">
                <h3>Recent Claude Code Activities</h3>
                <div class="log-container" id="activity-log">
                    <p>Loading...</p>
                </div>
            </div>

            <div id="recommendations-tab" class="tab-content">
                <h3>Claude's Recommendations</h3>
                <div id="recommendations-container">
                    <p>Loading...</p>
                </div>
            </div>

            <div id="report-tab" class="tab-content">
                <h3>Latest System Report</h3>
                <div id="report-timestamp"></div>
                <div class="report-container" id="report-content">
                    <p>Loading...</p>
                </div>
            </div>

            <div id="apps-tab" class="tab-content">
                <h3>Monitored Applications</h3>
                <div id="apps-container">
                    <p>Loading...</p>
                </div>
            </div>
        </section>

        <footer>
            <p>Last updated: <span id="last-update">--</span></p>
            <p>Auto-refresh every 30 seconds</p>
        </footer>
    </div>

    <script src="{{ url_for('static', filename='app.js') }}"></script>
</body>
</html>
